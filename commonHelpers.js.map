{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst KEY = \"42562534-6abe2af4317b1372b4a8ab981\";\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nexport async function getImages(request, page){\n  let truthRequest = request;  \n  if(request.includes(\" \")){\n    truthRequest = request.split(\" \").join(\"+\");\n  }\n\n  try {\n    const { data } = await axios.get(\"/?key=42562534-6abe2af4317b1372b4a8ab981&q=\"+truthRequest+\"&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=\"+page)\n    return data\n  } catch (error) {\n    if (error.response) {\n      // Статус ответа выходит за пределы 2xx\n      const { data, status, headers } = error.response\n      console.error(data)\n    } else if (error.request) {\n      // Отсутствует тело ответа\n      console.error(error.request)\n    } else {\n      // Ошибка, связанная с неправильной настройкой запроса\n      console.error(error.message)\n    }\n    // Другая ошибка\n    console.error(error.config)\n    // Подробная информация об ошибке\n    console.error(error.toJSON())\n  \n    throw new Error(error);\n  }\n}","export function addMarkup(date){\n\n    \n\n    return date.map(item => `\n    <li class=\"gallery-item\">\n        <a class=\"gallery-link\" href=\"${item.largeImageURL}\">\n            <img \n                class=\"gallery-image\" \n                src=\"${item.previewURL}\" \n                alt=\"${item.tags}\" \n                />\n        </a>\n    <ul class=\"statistic-list\">\n      <li class=\"statistic-item\">\n        <h3 class=\"statistic-title\">Likes</h3>\n        <p class=\"statistic-info\">${item.likes}</p>\n      </li>\n      <li class=\"statistic-item\">\n        <h3 class=\"statistic-title\">Views</h3>\n        <p class=\"statistic-info\">${item.views}</p>\n      </li>\n      <li class=\"statistic-item\">\n        <h3 class=\"statistic-title\">Comments</h3>\n        <p class=\"statistic-info\">${item.comments}</p>\n      </li>\n      <li class=\"statistic-item\">\n        <h3 class=\"statistic-title\">Downloads</h3>\n        <p class=\"statistic-info\">${item.downloads}</p>\n      </li>\n    </ul>\n  </li>`).join(\"\");\n}\n\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { getImages } from \"./js/pixabay-api\";\nimport { addMarkup } from \"./js/render-functions\";\n\nconst galleryForm = document.querySelector(\".gallery-form\");\nconst search = document.querySelector(\".gallery-search\")\nconst galleryList = document.querySelector(\".gallery\")\nconst loader = document.querySelector('.loader')\nconst moreBtn = document.querySelector('.btn-more')\nconst btnLoader = document.querySelector('.btn-loader')\nconst noMoreText = document.querySelector('.no-more');\nlet imageFetchPromise;\nconst option = {\n    overlayOpacity: 0.8,\n    captionsData: 'alt',\n    captionDelay: 250,\n  };\n  const perPage = 15;\n  let page = 1;\n  let totalImage = 0;\n\nlet gallery = new SimpleLightbox('.gallery a', option);\n\ngalleryForm.addEventListener(\"submit\", event => {\n    event.preventDefault();\n    page = 1;\n    moreBtn.classList.add(\"is-hidden\")\n    noMoreText.classList.add(\"is-hidden\")\n    if(search.value.trim() ===\"\"){\n        return;\n    }\n    galleryList.innerHTML = \"\";\n    loader.classList.remove(\"is-hidden\")\n    imageFetchPromise = getImages(search.value.trim(), page);\n    imageFetchPromise.then(data => {\n        if(!data.totalHits){\n            iziToast.error({\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'topRight',\n            })\n        }else{\n            totalImage = data.totalHits;\n            galleryList.insertAdjacentHTML(\"beforeend\", addMarkup(data.hits));\n            gallery.refresh();\n            if(totalImage > perPage){\n                moreBtn.classList.remove(\"is-hidden\")\n            }\n            else{\n                noMoreText.classList.remove(\"is-hidden\")\n            }\n        }\n    }).catch(error => {\n        console.error(error);\n    }).finally(() => {\n        loader.classList.add(\"is-hidden\")\n    })\n})\n\nmoreBtn.addEventListener(\"click\", () => {\n    moreBtn.classList.add(\"is-hidden\")\n    btnLoader.classList.remove(\"is-hidden\")\n    page += 1;\n    imageFetchPromise = getImages(search.value.trim(), page);\n    imageFetchPromise\n      .then(data => {\n        galleryList.insertAdjacentHTML(\"beforeend\", addMarkup(data.hits));\n        window.scrollBy({\n            top: galleryList.firstElementChild.getBoundingClientRect().height*2,\n            left: 0,\n            behavior: \"smooth\",\n          });\n        gallery.refresh();\n        \n    }).catch(error => {\n        console.error(error);\n    }).finally(() => {\n        btnLoader.classList.add(\"is-hidden\")\n        if(totalImage < (page) * perPage){\n            moreBtn.classList.add(\"is-hidden\")\n            noMoreText.classList.remove(\"is-hidden\")\n        }else{\n            moreBtn.classList.remove(\"is-hidden\")\n            noMoreText.classList.add(\"is-hidden\")\n        }\n    })\n})\n\n\n"],"names":["axios","getImages","request","page","truthRequest","data","error","status","headers","addMarkup","date","item","galleryForm","search","galleryList","loader","moreBtn","btnLoader","noMoreText","imageFetchPromise","option","perPage","totalImage","gallery","SimpleLightbox","event","iziToast"],"mappings":"owBAGAA,EAAM,SAAS,QAAU,0BAElB,eAAeC,EAAUC,EAASC,EAAK,CAC5C,IAAIC,EAAeF,EAChBA,EAAQ,SAAS,GAAG,IACrBE,EAAeF,EAAQ,MAAM,GAAG,EAAE,KAAK,GAAG,GAG5C,GAAI,CACF,KAAM,CAAE,KAAAG,CAAM,EAAG,MAAML,EAAM,IAAI,8CAA8CI,EAAa,6EAA6ED,CAAI,EAC7K,OAAOE,CACR,OAAQC,EAAO,CACd,GAAIA,EAAM,SAAU,CAElB,KAAM,CAAE,KAAAD,EAAM,OAAAE,EAAQ,QAAAC,CAAS,EAAGF,EAAM,SACxC,QAAQ,MAAMD,CAAI,CACxB,MAAeC,EAAM,QAEf,QAAQ,MAAMA,EAAM,OAAO,EAG3B,QAAQ,MAAMA,EAAM,OAAO,EAG7B,cAAQ,MAAMA,EAAM,MAAM,EAE1B,QAAQ,MAAMA,EAAM,QAAQ,EAEtB,IAAI,MAAMA,CAAK,CACtB,CACH,CCjCO,SAASG,EAAUC,EAAK,CAI3B,OAAOA,EAAK,IAAIC,GAAQ;AAAA;AAAA,wCAEYA,EAAK,aAAa;AAAA;AAAA;AAAA,uBAGnCA,EAAK,UAAU;AAAA,uBACfA,EAAK,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCAMIA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,oCAIVA,EAAK,KAAK;AAAA;AAAA;AAAA;AAAA,oCAIVA,EAAK,QAAQ;AAAA;AAAA;AAAA;AAAA,oCAIbA,EAAK,SAAS;AAAA;AAAA;AAAA,QAG1C,EAAE,KAAK,EAAE,CACjB,CCzBA,MAAMC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAS,SAAS,cAAc,iBAAiB,EACjDC,EAAc,SAAS,cAAc,UAAU,EAC/CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAU,SAAS,cAAc,WAAW,EAC5CC,EAAY,SAAS,cAAc,aAAa,EAChDC,EAAa,SAAS,cAAc,UAAU,EACpD,IAAIC,EACJ,MAAMC,EAAS,CACX,eAAgB,GAChB,aAAc,MACd,aAAc,GAClB,EACQC,EAAU,GAChB,IAAIlB,EAAO,EACPmB,EAAa,EAEfC,EAAU,IAAIC,EAAe,aAAcJ,CAAM,EAErDR,EAAY,iBAAiB,SAAUa,GAAS,CAC5CA,EAAM,eAAc,EACpBtB,EAAO,EACPa,EAAQ,UAAU,IAAI,WAAW,EACjCE,EAAW,UAAU,IAAI,WAAW,EACjCL,EAAO,MAAM,KAAI,IAAM,KAG1BC,EAAY,UAAY,GACxBC,EAAO,UAAU,OAAO,WAAW,EACnCI,EAAoBlB,EAAUY,EAAO,MAAM,KAAI,EAAIV,CAAI,EACvDgB,EAAkB,KAAKd,GAAQ,CACvBA,EAAK,WAMLiB,EAAajB,EAAK,UAClBS,EAAY,mBAAmB,YAAaL,EAAUJ,EAAK,IAAI,CAAC,EAChEkB,EAAQ,QAAO,EACZD,EAAaD,EACZL,EAAQ,UAAU,OAAO,WAAW,EAGpCE,EAAW,UAAU,OAAO,WAAW,GAZ3CQ,EAAS,MAAM,CACX,QAAS,2EACT,SAAU,UAC1B,CAAa,CAYb,CAAK,EAAE,MAAMpB,GAAS,CACd,QAAQ,MAAMA,CAAK,CAC3B,CAAK,EAAE,QAAQ,IAAM,CACbS,EAAO,UAAU,IAAI,WAAW,CACxC,CAAK,EACL,CAAC,EAEDC,EAAQ,iBAAiB,QAAS,IAAM,CACpCA,EAAQ,UAAU,IAAI,WAAW,EACjCC,EAAU,UAAU,OAAO,WAAW,EACtCd,GAAQ,EACRgB,EAAoBlB,EAAUY,EAAO,MAAM,KAAI,EAAIV,CAAI,EACvDgB,EACG,KAAKd,GAAQ,CACZS,EAAY,mBAAmB,YAAaL,EAAUJ,EAAK,IAAI,CAAC,EAChE,OAAO,SAAS,CACZ,IAAKS,EAAY,kBAAkB,sBAAuB,EAAC,OAAO,EAClE,KAAM,EACN,SAAU,QACtB,CAAW,EACHS,EAAQ,QAAO,CAEvB,CAAK,EAAE,MAAMjB,GAAS,CACd,QAAQ,MAAMA,CAAK,CAC3B,CAAK,EAAE,QAAQ,IAAM,CACbW,EAAU,UAAU,IAAI,WAAW,EAChCK,EAAcnB,EAAQkB,GACrBL,EAAQ,UAAU,IAAI,WAAW,EACjCE,EAAW,UAAU,OAAO,WAAW,IAEvCF,EAAQ,UAAU,OAAO,WAAW,EACpCE,EAAW,UAAU,IAAI,WAAW,EAEhD,CAAK,CACL,CAAC"}